ğŸ“‹ Plan: Rebuild Inbox Page - Modern Gmail-Style Interface
Current State Analysis
The existing inbox has:

âœ… Email decoding (quoted-printable/base64) already implemented in SanitizedEmailContent
âœ… Basic order linking functionality
âœ… Email thread viewing and reply capability
âœ… Attachment support
âŒ 2-column layout (needs 3-column Gmail-style)
âŒ Limited filters (no folder structure)
âŒ No keyboard navigation
âŒ No bulk actions
âŒ Basic search (only subject/email)
Phase 1: Architecture & Data Layer (Foundation)
1.1 Fix LSP Errors

Fix TypeScript errors in server/routes.ts (7 diagnostics)
Ensure type safety for error handling
1.2 Enhance Email Schema & API

Add folder support to email threads (Inbox, Sent, Archived, Starred)
Add starred and archived fields to database schema
Update API endpoints to support filtering by folder
Add bulk action endpoints (mark as read/unread, archive, star, delete)
1.3 Improve Search & Filtering

Enhance search to include email body content
Add order number detection in search
Create filter combinations (With Order / Without Order)
Phase 2: UI/UX - Gmail-Style 3-Column Layout
2.1 Left Sidebar Component (email-sidebar.tsx)

Folder navigation (Inbox, Sent, Archived, Starred, Unread)
Filter sections (With Order / Without Order)
Search bar at top
"+ New Email" button
Collapsible for mobile
2.2 Middle Column - Email List (email-list.tsx)

Checkbox for bulk selection
Sender name/email display
Subject line with snippet
Date/time formatting (Today/Yesterday/Date)
Order badge indicator (green badge for linked orders)
Unread = bold styling
Hover actions toolbar
Keyboard navigation (â†‘ â†“ Enter)
Pagination or infinite scroll
2.3 Right Column - Thread View (Enhanced email-thread-view.tsx)

Gmail-style conversation thread
Improved sender info display
Message content with proper decoding
Attachments display
Reply box with rich text editor
Top action bar: Reply, Forward, Archive, Star, Link to Order
Order integration panel
Phase 3: Enhanced Features
3.1 Order Integration Improvements

Auto-detect order numbers in email (regex patterns)
Auto-link on email sync
Visual order badge in email list (green "Order #1234")
"Link to Order" modal with search
"Switch Order" dropdown
Order summary panel in thread view
3.2 Reply & Compose Enhancement

Rich text editor (upgrade from plain textarea)
Internal staff notes (visible to team only)
Drag & drop attachments
Quick template replies dropdown
Email signature support
3.3 Core Actions & Shortcuts

Bulk selection with actions bar
Mark as read/unread, star, archive, delete
Keyboard shortcuts:
r = reply
a = archive
s = star
j/k = navigate up/down
Enter = open thread
Auto-refresh/polling for new emails
Internal notifications
Phase 4: Advanced Features
4.1 Email Management

Create Case from email
Smart customer/order matching
SLA reminder indicator (e.g., "No reply for 3 days")
Integration with order and repair modules
Export conversation as PDF (optional)
4.2 UI Polish & Accessibility

Clean Gmail-like aesthetics
Color cues (Blue=unread, Green=with order)
Responsive mobile view
Loading states and skeleton screens
Error boundaries
Dark mode support
Phase 5: Testing & Optimization
5.1 Testing

Email decoding verification (quoted-printable, base64, HTML)
Order auto-linking accuracy
Keyboard navigation functionality
Bulk actions reliability
Mobile responsiveness
5.2 Performance

Optimize email list rendering (virtualization for large lists)
Lazy load thread messages
Debounce search input
Cache management with TanStack Query
Implementation Strategy
File Structure:

client/src/pages/
  â””â”€â”€ inbox.tsx (main page with 3-column layout)
client/src/components/email/
  â”œâ”€â”€ email-sidebar.tsx (NEW - left sidebar)
  â”œâ”€â”€ email-list.tsx (NEW - middle column)
  â”œâ”€â”€ email-list-item.tsx (NEW - individual email row)
  â”œâ”€â”€ email-thread-view.tsx (ENHANCED - right column)
  â”œâ”€â”€ email-compose.tsx (ENHANCED - rich text)
  â”œâ”€â”€ email-attachments.tsx (existing)
  â”œâ”€â”€ sanitized-email-content.tsx (existing - already handles decoding)
  â””â”€â”€ email-actions-bar.tsx (NEW - bulk actions)
server/routes.ts (ENHANCED - new endpoints)
shared/schema.ts (UPDATED - new fields)
Key Technical Decisions:

âœ… Keep existing email decoding (already works well)
âœ… Use shadcn/ui components for consistency
âœ… TanStack Query for state management
âœ… Add react-resizable-panels for adjustable columns
âœ… Consider @tiptap/react or quill for rich text editor
âœ… Add keyboard event handlers at page level
Estimated Task Breakdown (15-20 tasks):
Fix LSP errors in server/routes.ts
Update database schema for folders/starred/archived
Create bulk action API endpoints
Build email-sidebar component
Build email-list component
Build email-list-item component
Add keyboard navigation
Add bulk selection UI
Enhance email-thread-view
Add rich text editor to compose/reply
Implement order auto-detection
Create order linking modal
Add quick reply templates
Implement keyboard shortcuts
Add auto-refresh polling
Mobile responsive layout
Testing & bug fixes
UI polish and animations